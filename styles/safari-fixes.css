/* SAFARI & MACOS RENDERING FIXES */

/* 
   Forces a new composite layer to prevent "paint flashing" or ghosting 
   during 3D transforms. Essential for floating cards/elements.
   Applies backface-visibility: hidden to prevent double-rendering bugs.
*/
.macos-layer-fix {
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  -webkit-font-smoothing: subpixel-antialiased;
  will-change: transform; /* Hint to browser to promote layer */
}

/* 
   Safe Glass Replacement:
   Replaces CPU/GPU expensive backdrop-filter with high-quality 
   semi-transparent layers that look identical but perform 60fps+ 
*/
.macos-glass {
  background-color: rgba(255, 255, 255, 0.95);
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
}

.macos-glass-dark {
  background-color: rgba(15, 23, 42, 0.95); /* slate-900/95 */
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Explicit class for elements that requested no blur glass */
.macos-no-blur-glass {
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid rgba(226, 232, 240, 0.8); /* slate-200 */
  box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.1);
}

/* 
   Global override for Safari to prevent glitches on any remaining 
   backdrop-filters in deep nested structures 
*/
@supports (-webkit-touch-callout: none) {
  .backdrop-blur-sm, 
  .backdrop-blur-md, 
  .backdrop-blur-lg, 
  .backdrop-blur-xl, 
  .backdrop-blur-2xl, 
  .backdrop-blur-3xl {
    /* Fallback to simple transparency on Safari to prevent scroll jitter */
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background-color: rgba(255, 255, 255, 0.98); 
  }
  
  /* Dark mode specific override if parent is dark */
  .dark .backdrop-blur-md {
    background-color: rgba(0, 0, 0, 0.95);
  }
}

/* Reduced Motion Preference - Disables heavy animations */
@media (prefers-reduced-motion: reduce) {
  *, ::before, ::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}